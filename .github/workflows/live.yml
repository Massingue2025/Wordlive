name: Iniciar Live

on:
  repository_dispatch:
    types: [iniciar-live]

jobs:
  iniciar-live:
    runs-on: ubuntu-latest

    steps:
    - name: 📁 Clonar repositório
      uses: actions/checkout@v3

    - name: 🧰 Instalar dependências
      run: |
        sudo apt update
        sudo apt install -y ffmpeg
        npm install playwright
        npx playwright install chromium

    - name: 📡 Iniciar transmissão com navegador headless
      run: |
        node live-action/iniciar-live.js "${{ github.event.client_payload.video_path }}" "${{ github.event.client_payload.stream_url }}"
